parameters:
  env(UNAME_INFO): ''
  uname_info: '%env(uname:UNAME_INFO)%'

services:
  app_modify_docker_file:
    class: SprykerSdk\Sdk\Extension\Service\AppDockerFileModifier
    arguments:
      - '@yaml_parser'
  app_modify_composer_file:
    class: SprykerSdk\Sdk\Extension\Service\AppComposerFileModifier
  generate_app_change_name_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\ChangeNamesCommand
    arguments:
      - '@app_modify_composer_file'
      - '@app_modify_docker_file'
  check_git_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\CheckGitCommand
  generate_app_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\GenerateAppCommand
  generate_app_change_php_version_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\ChangePhpVersionCommand
    arguments:
      - '@app_modify_composer_file'
      - '@app_modify_docker_file'
  generate_app_add_aop_sdk_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\AddAcpSdkCommand
    arguments:
      - '@app_modify_composer_file'
  generate_app_allow_default_composer_plugins_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\AllowDefaultComposerPluginCommand
    arguments:
      - '@app_modify_composer_file'
  generate_app_update_dependencies_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\UpdateDependenciesCommand
  add_docker_sdk_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\AddDockerSdkCommand
  check_mutagen_for_mac_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\CheckMutagenCommand
  generate_app_next_steps_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\NextAppStepsCommand
  business_model_arm_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\BusinessModelARMCommand
    arguments:
      - '@yaml_parser'
      - "%kernel.project_dir%"
  check_docker_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\CheckDockerCommand
  docker_init_up_steps_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\DockerInitUpStepsCommand
  generate_app:
    class: SprykerSdk\Sdk\Extension\Tasks\GenerateAppTask
    tags: [ 'sdk.task' ]
    arguments:
      $commands:
        - '@check_git_command'
        - '@generate_app_command'
        - '@generate_app_change_name_command'
        - '@generate_app_change_php_version_command'
        - '@generate_app_add_aop_sdk_command'
        - '@generate_app_allow_default_composer_plugins_command'
        - '@generate_app_update_dependencies_command'
        - '@add_docker_sdk_command'
        - '@generate_app_next_steps_command'
  clone_business_model_command:
    class: SprykerSdk\Sdk\Extension\Tasks\Commands\CloneBusinessModelRepositoryCommand
  business_model_installer_task:
    class: SprykerSdk\Sdk\Extension\Tasks\BusinessModelInstallerTask
    tags: [ 'sdk.task' ]
    arguments:
      $commands:
        - '@check_git_command'
#        - '@check_docker_command'
#        - '@check_mutagen_for_mac_command'
        - '@clone_business_model_command'
        - '@add_docker_sdk_command'
        - '@business_model_arm_command'
        - '@docker_init_up_steps_command'
  sdk_directory_value_resolver:
    class: SprykerSdk\Sdk\Extension\ValueResolvers\SdkDirectoryValueResolver
    tags: ["sdk.value_resolver"]
    arguments:
      - '@value_receiver'
      - '%kernel.project_dir%'
  pc_system_value_resolver:
    class: SprykerSdk\Sdk\Extension\ValueResolvers\PCSystemValueResolver
    tags: [ "sdk.value_resolver" ]
    arguments:
      - '@value_receiver'
      - '%uname_info%'

  app_php_version_value_resolver:
    class: SprykerSdk\Sdk\Extension\ValueResolvers\AppPhpVersionValueResolver
    tags: [ 'sdk.value_resolver' ]
    arguments:
      - '@value_receiver'

  remove_report_dir:
    class: SprykerSdk\Sdk\Extension\Tasks\RemoveRepDirTask
    tags: ["sdk.task"]
    arguments:
      - "@violation_report_repository"
  SprykerSdk\Sdk\Extension\Settings\Initializers\CreateDirectoryInitializer:
    tags: ["sdk.setting_initializer"]
    public: true
  create_directory_initializer:
    alias: SprykerSdk\Sdk\Extension\Settings\Initializers\CreateDirectoryInitializer
    public: true
  SprykerSdk\Sdk\Extension\Settings\Initializers\ProjectUuidInitializer:
    tags: ["sdk.setting_initializer"]
    public: true
    arguments:
      - "@project_setting_repository"
  project_uuid_initializer:
    alias: SprykerSdk\Sdk\Extension\Settings\Initializers\ProjectUuidInitializer
    public: true
  SprykerSdk\Sdk\Extension\Settings\Initializers\ProjectWorkflowInitializer:
    tags: ["sdk.setting_initializer"]
    public: true
    arguments:
      - "@project_setting_repository"
      - "@workflow_repository"
      - "@project_workflow"
  project_workflow_initializer:
    alias: SprykerSdk\Sdk\Extension\Settings\Initializers\ProjectWorkflowInitializer
    public: true
  option_value_resolver:
    class: SprykerSdk\Sdk\Extension\ValueResolvers\OptionValueResolver
    arguments:
      - '@value_receiver'
    tags: ['sdk.value_resolver']

  # Transition resolvers
  transition_boolean_resolver:
    class: SprykerSdk\Sdk\Extension\Workflow\TransitionBooleanResolver
    public: true

  uname_env_var_processor:
    class: SprykerSdk\Sdk\Extension\DependencyInjection\EnvVarProcessor\UnameEnvVarProcessor
    tags: ['container.env_var_processor']
